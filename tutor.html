<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Админ</title>

<style>

body{
font-family:Arial;
padding:20px;
}

textarea{
width:400px;
height:200px;
}

button{
margin:5px;
padding:5px;
}

</style>

</head>

<body>

<h2>Админка</h2>

<input id="name" placeholder="Имя ученика">

<button onclick="addStudent()">Добавить</button>

<hr>

<div id="students"></div>

<script>

let data={}

fetch("data.json?"+Date.now())
.then(r=>r.json())
.then(d=>{

data=d
render()

})

function render(){

const div=document.getElementById("students")

div.innerHTML=""

for(const name in data.students){

div.innerHTML+=`

<hr>

<h3>${name}</h3>

<textarea id="words_${name}">${formatWords(name)}</textarea>

<br>

<button onclick="saveWords('${name}')">Сохранить слова</button>

<button onclick="deleteStudent('${name}')">Удалить ученика</button>

`

}

}

function formatWords(name){

return data.students[name].words
.map(w=>`${w.ru} = ${w.en}`)
.join("\n")

}

function saveWords(name){

const text=
document.getElementById("words_"+name).value

const lines=text.split("\n")

data.students[name].words=[]

lines.forEach(line=>{

if(line.includes("=")){

const parts=line.split("=")

data.students[name].words.push({

ru:parts[0].trim(),
en:parts[1].trim()

})

}

})

alert("Сохранено (локально)")

}

function addStudent(){

const name=document.getElementById("name").value

data.students[name]={

words:[],
attempts:[]

}

render()

}

function deleteStudent(name){

delete data.students[name]

render()

}

</script>

</body>
</html>
