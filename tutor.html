<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">

<style>

body{
font-family:Arial;
padding:20px;
max-width:700px;
margin:auto;
}

input{
width:100%;
padding:6px;
margin-top:5px;
margin-bottom:10px;
}

button{
padding:10px 20px;
margin:10px 5px;
}

.correct{
color:green;
}

.wrong{
color:red;
}

</style>
</head>
<body>

<h2 id="student"></h2>

<div id="test"></div>

<button onclick="check()">Проверить</button>

<button onclick="retry()">Пройти заново</button>

<div id="result"></div>

<script>

document.addEventListener("paste",e=>e.preventDefault())
document.addEventListener("copy",e=>e.preventDefault())

function getStudents(){
return JSON.parse(localStorage.getItem("students")||"{}")
}

function saveStudents(data){
localStorage.setItem("students",JSON.stringify(data))
}

const student=localStorage.getItem("currentStudent")

document.getElementById("student").innerText=student

function load(){

const data=getStudents()

const words=data[student].words||[]

const div=document.getElementById("test")

div.innerHTML=""

words.forEach((w,i)=>{

div.innerHTML+=`
<div>
${w.ru}
<input autocomplete="off" data-index="${i}">
</div>
`

})

}

function check(){

const data=getStudents()

const words=data[student].words

const inputs=document.querySelectorAll("input")

let correct=0

let detail=[]

inputs.forEach(input=>{

const i=input.dataset.index

const answer=input.value.trim()

const correctWord=words[i].en

if(answer.toLowerCase()===correctWord.toLowerCase()){

correct++

detail.push(`<span class="correct">${words[i].ru} = ${correctWord}</span>`)

}else{

detail.push(`<span class="wrong">${words[i].ru} = ${answer} ❌ (правильно: ${correctWord})</span>`)

}

})

const percent=Math.round(correct/words.length*100)

if(!data[student].attempts)
data[student].attempts=[]

data[student].attempts.push({

percent,
detail,
date:new Date().toLocaleString()

})

saveStudents(data)

document.getElementById("result").innerHTML=
`<h3>${percent}%</h3>`+detail.join("<br>")

}

function retry(){

load()

document.getElementById("result").innerHTML=""

}

load()

</script>

</body>
</html>
