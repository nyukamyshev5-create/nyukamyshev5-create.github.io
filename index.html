<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Диктанты</title>

<style>

body{
font-family:Arial;
background:linear-gradient(135deg,#4e73df,#1cc88a);
margin:0;
padding:0;
text-align:center;
}

.container{
background:white;
max-width:800px;
margin:40px auto;
padding:30px;
border-radius:15px;
box-shadow:0 10px 30px rgba(0,0,0,0.2);
}

button{
padding:10px 15px;
margin:5px;
border:none;
border-radius:8px;
cursor:pointer;
background:#4e73df;
color:white;
}

input{
padding:8px;
margin:5px;
font-size:16px;
}

.correct{color:green;}
.wrong{color:red;}

#test{display:none;}
#adminPanel{display:none;}

</style>
</head>
<body>

<div class="container">

<h2>Выберите ученика</h2>
<div id="studentsList"></div>

<button onclick="showAdminLogin()">Админ</button>

<div id="adminLogin" style="display:none;">
<input type="password" id="adminPass" placeholder="Пароль">
<button onclick="loginAdmin()">Войти</button>
</div>

<div id="adminPanel">

<h3>Добавить ученика</h3>

<input id="newStudentName" placeholder="Имя"><br>

<textarea id="newStudentWords" rows="10" cols="40"
placeholder="дом=house&#10;работа=work"></textarea><br>

<button onclick="addStudent()">Добавить</button>

</div>

<div id="test">

<h3 id="studentTitle"></h3>

<div id="words"></div>

<button onclick="send()">Отправить</button>
<button onclick="restart()">Начать новую попытку</button>

<div id="result"></div>

</div>

</div>

<script>

const ADMIN_PASSWORD="tutorai";

let students=JSON.parse(localStorage.getItem("studentsDB"))||{};
let currentStudent="";
let words=[];

updateStudents();

function updateStudents(){

localStorage.setItem("studentsDB",JSON.stringify(students));

let html="";

for(let name in students){

html+=`<button onclick="startTest('${name}')">${name}</button>`;

}

document.getElementById("studentsList").innerHTML=html;

}

function startTest(name){

currentStudent=name;
words=students[name];

document.getElementById("studentTitle").innerText=name;

let html="";

words.forEach((w,i)=>{

html+=`
<div>

${w[0]}

<input

id="w${i}"

autocomplete="off"
autocorrect="off"
autocapitalize="off"
spellcheck="false"

onpaste="return false"
ondrop="return false"

oncontextmenu="return false"

onkeydown="return blockKeys(event)"

>

</div>
`;

});

document.getElementById("words").innerHTML=html;

document.getElementById("test").style.display="block";

}

function blockKeys(e){

if(e.ctrlKey && (
e.key==="v" ||
e.key==="c" ||
e.key==="x" ||
e.key==="Insert"
)) return false;

return true;

}

function send(){

let correct=0;

words.forEach((w,i)=>{

let val=document.getElementById("w"+i).value.trim();

if(val.toLowerCase()===w[1].toLowerCase())
correct++;

});

let percent=Math.round(correct/words.length*100);

document.getElementById("result").innerHTML=
"<h3>Результат: "+percent+"%</h3>";

}

function restart(){

startTest(currentStudent);

}

function showAdminLogin(){

document.getElementById("adminLogin").style.display="block";

}

function loginAdmin(){

let pass=document.getElementById("adminPass").value;

if(pass===ADMIN_PASSWORD){

document.getElementById("adminPanel").style.display="block";

}else{

alert("Неверный пароль");

}

}

function addStudent(){

let name=document.getElementById("newStudentName").value.trim();

let raw=document.getElementById("newStudentWords").value.trim();

if(!name||!raw){

alert("Заполните поля");

return;

}

let lines=raw.split("\n");

students[name]=[];

lines.forEach(line=>{

let parts=line.split("=");

if(parts.length===2){

students[name].push([
parts[0].trim(),
parts[1].trim()
]);

}

});

updateStudents();

alert("Ученик добавлен");

}

</script>

</body>
</html>
