<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Админка</title>

<style>
body{
font-family:Arial;
padding:20px;
max-width:800px;
margin:auto;
}

textarea{
width:100%;
height:150px;
margin-top:10px;
}

input{
width:100%;
padding:8px;
margin-top:10px;
}

button{
margin:5px;
padding:6px 12px;
cursor:pointer;
}

.student{
border:1px solid #ccc;
padding:10px;
margin-top:10px;
}
</style>
</head>
<body>

<h2>Админка</h2>

<input id="studentName" placeholder="Имя ученика">

<textarea id="words" placeholder="долгосрочный спад = long-term decline"></textarea>

<button onclick="saveStudent()">Сохранить ученика</button>

<hr>

<div id="students"></div>

<script>

function getStudents(){
return JSON.parse(localStorage.getItem("students")||"{}")
}

function saveStudents(data){
localStorage.setItem("students",JSON.stringify(data))
}

function parseWords(text){

return text
.split("\n")
.map(line=>{

const parts=line.split("=")

if(parts.length<2)return null

return {
ru:parts[0].trim(),
en:parts[1].trim()
}

})
.filter(x=>x)

}

function saveStudent(){

const name=document.getElementById("studentName").value.trim()

const wordsText=document.getElementById("words").value.trim()

if(!name){
alert("Введите имя")
return
}

const data=getStudents()

if(!data[name])
data[name]={attempts:[]}

data[name].words=parseWords(wordsText)

saveStudents(data)

loadStudents()

alert("Сохранено")

}

function deleteStudent(name){

if(!confirm("Удалить ученика?"))return

const data=getStudents()

delete data[name]

saveStudents(data)

loadStudents()

}

function showAttempts(name){

const data=getStudents()

const div=document.getElementById("attempts_"+name)

const attempts=data[name].attempts||[]

if(attempts.length===0){
div.innerHTML="Нет попыток"
return
}

let html=""

attempts.forEach((a,i)=>{

html+=`
<div>
<b>Попытка ${i+1}: ${a.percent}%</b><br>
${a.detail.join("<br>")}
<hr>
</div>
`

})

div.innerHTML=html

}

function loadStudents(){

const data=getStudents()

const div=document.getElementById("students")

div.innerHTML=""

Object.keys(data).forEach(name=>{

div.innerHTML+=`
<div class="student">

<b>${name}</b><br>

<button onclick="showAttempts('${name}')">
Попытки
</button>

<button onclick="deleteStudent('${name}')">
Удалить
</button>

<div id="attempts_${name}"></div>

</div>
`

})

}

loadStudents()

</script>

</body>
</html>
